<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Server Status</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<header class="header-bar">
  <h1 class="main-title">Vega Status</h1>
  <div class="status-banner">All Systems Operational</div>

</header>

        <main class="services-grid">
            <!-- FiveM Server -->
            <div class="service-card">
                <div class="service-header">
                    <div class="service-name">
                        <span class="service-icon"></span>
                        FiveM Server
                    </div>
                    <div class="status-badge status-operational">Operational</div>
                </div>
                <div class="uptime-bar-container">
                    <div class="uptime-bar" style="width: 99.8%"></div>
                </div>
                <div class="uptime-stats">
                    <span class="time-period">90 days ago</span>
                    <span class="uptime-percentage">99.8% uptime</span>
                    <span class="time-period">Today</span>
                </div>
            </div>

            <!-- Website -->
            <div class="service-card">
                <div class="service-header">
                    <div class="service-name">
                        <span class="service-icon"></span>
                        Website
                    </div>
                    <div class="status-badge status-operational">Operational</div>
                </div>
                <div class="uptime-bar-container">
                    <div class="uptime-bar" style="width: 99.9%"></div>
                </div>
                <div class="uptime-stats">
                    <span class="time-period">90 days ago</span>
                    <span class="uptime-percentage">99.9% uptime</span>
                    <span class="time-period">Today</span>
                </div>
            </div>

            <!-- Discord Bot -->
            <div class="service-card">
                <div class="service-header">
                    <div class="service-name">
                        <span class="service-icon"></span>
                        Vega Bot
                    </div>
                    <div class="status-badge status-operational">Operational</div>
                </div>
                <div class="uptime-bar-container">
                    <div class="uptime-bar" style="width: 99.9%"></div>
                </div>
                <div class="uptime-stats">
                    <span class="time-period">90 days ago</span>
                    <span class="uptime-percentage">99.9% uptime</span>
                    <span class="time-period">Today</span>
                </div>
            </div>

            <!-- Second Discord Bot -->
            <div class="service-card">
                <div class="service-header">
                    <div class="service-name">
                        <span class="service-icon"></span>
                        Manthrika Charlie
                    </div>
                    <div class="status-badge status-operational">Operational</div>
                </div>
                <div class="uptime-bar-container">
                    <div class="uptime-bar" style="width: 97.3%"></div>
                </div>
                <div class="uptime-stats">
                    <span class="time-period">90 days ago</span>
                    <span class="uptime-percentage">97.3% uptime</span>
                    <span class="time-period">Today</span>
                </div>
            </div>
        </main>

        <footer class="footer">
            <p>Last updated: <span id="lastUpdate"></span></p>
        </footer>
    </div>

    <script>
        // Update the last updated time
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('lastUpdate').textContent = timeString;
        }

        // Create floating particles
        function createParticle() {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = Math.random() * window.innerWidth + 'px';
            particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
            particle.style.animationDelay = Math.random() * 2 + 's';
            document.body.appendChild(particle);

            setTimeout(() => {
                particle.remove();
            }, 6000);
        }

        // Initialize
        updateTime();
        setInterval(updateTime, 1000);
        
        // Create particles periodically
        setInterval(createParticle, 1000);

        // Service configuration - UPDATE THESE URLs WITH YOUR ACTUAL SERVICES
        const serviceConfig = {
            'fivem': {
                name: 'FiveM Server',
                url: '148.113.43.219:30120', // e.g., '192.168.1.100:30120'
                type: 'fivem'
            },
            'website': {
                name: 'Website',
                url: 'https://vegacity.in', // Your website URL
                type: 'http'
            },
            'discord': {
                name: 'Vega Bot',
                url: 'http://51.79.173.22:3100/status',
                type: 'bot'
            },
            'discord2': {
                name: 'Manthrika Charlie',
                url: 'http://51.79.173.22:3000/status', // Add your second bot's status endpoint
                type: 'bot'
            }
        };

        // Function to check service status
        async function checkServiceStatus(service) {
            try {
                let response;
                
                switch(service.type) {
                    case 'http':
                        // Check HTTP/HTTPS services
                        response = await fetch(service.url, {
                            method: 'HEAD',
                            mode: 'no-cors', // To avoid CORS issues
                            cache: 'no-cache'
                        });
                        return { status: 'operational', responseTime: Date.now() };
                        
                    case 'fivem':
                        // For FiveM servers, you'd typically check via their API
                        // This is a placeholder - you'll need to implement based on your server setup
                        try {
                            response = await fetch(`http://${service.url}/info.json`, {
                                method: 'GET',
                                mode: 'no-cors'
                            });
                            return { status: 'operational', responseTime: Date.now() };
                        } catch (error) {
                            return { status: 'down', responseTime: null };
                        }
                        
                    case 'bot':
                        // Check Discord bot status by reading the JSON response
                        try {
                            const controller = new AbortController();
                            const timeoutId = setTimeout(() => controller.abort(), 8000);
                            
                            const response = await fetch(service.url, {
                                method: 'GET',
                                headers: {
                                    'Accept': 'application/json',
                                },
                                signal: controller.signal,
                                cache: 'no-cache'
                            });
                            
                            clearTimeout(timeoutId);
                            
                            if (response.ok) {
                                const data = await response.json();
                                console.log('Bot status response:', data);
                                
                                // Check the actual bot status from your JSON response
                                if (data.status === 'online') {
                                    console.log(`Bot ${data.bot} is online`);
                                    return { status: 'operational', responseTime: Date.now() };
                                } else {
                                    console.log(`Bot ${data.bot} is offline`);
                                    return { status: 'down', responseTime: null };
                                }
                            } else {
                                console.log('Bot status endpoint returned error:', response.status);
                                return { status: 'down', responseTime: null };
                            }
                        } catch (error) {
                            console.log('Bot status check failed:', error.message);
                            
                            // Fallback: If CORS still fails, assume server down means bot down
                            if (error.name === 'AbortError') {
                                console.log('Bot status check timed out');
                            } else if (error.message.includes('CORS')) {
                                console.log('CORS error - you need to add CORS headers to your bot status endpoint');
                            }
                            return { status: 'down', responseTime: null };
                        }
                    default:
                        return { status: 'down', responseTime: null };
                }
            } catch (error) {
                console.log(`Service ${service.name} check failed:`, error);
                return { status: 'down', responseTime: null };
            }
        }

        // Function to update service status in UI
        function updateServiceStatus(serviceName, statusData) {
            const serviceCards = document.querySelectorAll('.service-card');
            
            serviceCards.forEach(card => {
                const nameElement = card.querySelector('.service-name');
                if (nameElement.textContent.trim().includes(serviceName)) {
                    const badge = card.querySelector('.status-badge');
                    
                    // Remove all status classes
                    badge.classList.remove('status-operational', 'status-maintenance', 'status-down');
                    
                    // Add new status class and text
                    badge.classList.add(`status-${statusData.status}`);
                    badge.textContent = statusData.status.charAt(0).toUpperCase() + statusData.status.slice(1);
                    
                    // Update the main banner if any service is down
                    updateMainBanner();
                }
            });
        }

        // Function to update the main status banner
        function updateMainBanner() {
            const badges = document.querySelectorAll('.status-badge');
            const banner = document.querySelector('.status-banner');
            
            let allOperational = true;
            let hasDown = false;
            
            badges.forEach(badge => {
                if (badge.classList.contains('status-down')) {
                    hasDown = true;
                    allOperational = false;
                } else if (badge.classList.contains('status-maintenance')) {
                    allOperational = false;
                }
            });
            
            if (hasDown) {
                banner.textContent = 'Service Disruption Detected';
                banner.style.background = 'linear-gradient(45deg, #ff4444, #cc0000)';
                banner.style.color = '#fff';
            } else if (!allOperational) {
                banner.textContent = 'Some Services Under Maintenance';
                banner.style.background = 'linear-gradient(45deg, #ffaa00, #ff8800)';
                banner.style.color = '#000';
            } else {
                banner.textContent = 'All Systems Operational';
                banner.style.background = 'linear-gradient(45deg, #00ff88, #00cc6a)';
                banner.style.color = '#000';
            }
        }

        // Function to check all services
        async function checkAllServices() {
            console.log('Checking service status...');
            
            for (const [key, service] of Object.entries(serviceConfig)) {
                const statusData = await checkServiceStatus(service);
                updateServiceStatus(service.name, statusData);
            }
            
            // Update last checked time
            const lastChecked = new Date().toLocaleString('en-US', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            
            // Add status check indicator
            let statusIndicator = document.getElementById('status-check-indicator');
            if (!statusIndicator) {
                statusIndicator = document.createElement('div');
                statusIndicator.id = 'status-check-indicator';
                statusIndicator.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: rgba(0, 255, 255, 0.1);
                    border: 1px solid rgba(0, 255, 255, 0.3);
                    color: #00ffff;
                    padding: 8px 16px;
                    border-radius: 20px;
                    font-size: 12px;
                    backdrop-filter: blur(10px);
                    z-index: 1000;
                `;
                document.body.appendChild(statusIndicator);
            }
            
            statusIndicator.textContent = `Last checked: ${lastChecked}`;
            
            // Flash the indicator
            statusIndicator.style.background = 'rgba(0, 255, 255, 0.3)';
            setTimeout(() => {
                statusIndicator.style.background = 'rgba(0, 255, 255, 0.1)';
            }, 1000);
        }

        // Auto-check services every 5 minutes (300000 milliseconds)
        function startStatusMonitoring() {
            // Check immediately on load
            checkAllServices();
            
            // Then check every 5 minutes
            setInterval(checkAllServices,  60 * 1000);
            
            console.log('Status monitoring started - checking every 5 minutes');
        }

        // Initialize status monitoring
        startStatusMonitoring();
    </script>
</body>
</html>